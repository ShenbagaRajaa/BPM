<div class="md:p-4 pb-16 h-screen flex flex-col tablet:bg-lblue tablet:px-4">
  <!-- Navigation bar with a title and create button if the user has permission -->
  <app-navigationbar
    pageTitle="Department Management"
    [arrow]="false"
    [button]="hasPermissionToCreate"
    buttonLabel="CREATE NEW DEPARTMENT"
    (activeValue)="createDepartment()"
  ></app-navigationbar>
  <!-- Desktop and tablet view for the department list -->
  <div
    class="w-full bg-white shadow-lg p-4 pb-28 flex-grow md:flex tablet:flex hidden md:pb-16"
  >
    <div class="p-4 w-full">
      <h4 class="text-xl mb-4">Department List</h4>
      <div class="rounded-lg border p-4">
        <div
          class="flex flex-wrap items-center justify-between space-y-4 md:space-y-0"
        >
          <!-- Search input field for filtering departments -->
          <div class="hidden md:block w-full tablet:w-1/3 md:w-1/3">
            <app-input-field
              label="Search"
              (activeValue)="externalFilterChanged($event)"
              placeHolder="Search By Name, Code"
            ></app-input-field>
          </div>
        </div>

        <div class="mt-6">
          <!-- Ag-Grid for displaying department data -->
          <ag-grid-angular
            *ngIf="isBrowser"
            [rowData]="rowData"
            [columnDefs]="displayedColumns"
            class="ag-theme-quartz"
            [domLayout]="'autoHeight'"
            [rowHeight]="50"
            [pagination]="pagination"
            [paginationPageSize]="paginationPageSize"
            [paginationPageSizeSelector]="paginationPageSizeSelector"
            overlayNoRowsTemplate="<div style='position: absolute; top: 60px; left: 50%; transform: translateX(-50%); font-size: 16px; font-weight: bold; color: #555;'>
                No departments found matching your criteria.
              </div>"
          />
          <!-- Template for department name to make it clickable -->
          <ng-template #departmentNameTemplate let-department>
            <span
              class="department-name"
              style="cursor: pointer; color: blue"
              (click)="openDepartmentDetails(department)"
            >
              {{ department.departmentName }}
            </span>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
  <!-- Mobile view for department list -->
  <div class="block md:hidden tablet:hidden">
    <div class="w-full px-4">
      <!-- Search input for mobile view -->
      <app-input-field
        label="Search"
        placeHolder="Search By Name, Code"
        class="w-full"
        (activeValue)="externalFilterChanged($event)"
      ></app-input-field>
    </div>
    <!-- Mobile department list section -->
    <div
      class="mt-4 bg-mCard min-h-[650px] p-4 rounded-t-3xl border pt-12 pb-64"
    >
      <h4 class="text-xl font-semibold mb-4">Department List</h4>
      @if(rowData.length !== 0){ @for(data of rowData; track rowData){
      <div class="w-full bg-gray-100 p-4 rounded-lg mb-4 shadow-md">
        <div class="flex justify-between">
          <h5
            class="text-lg font-medium text-text"
            (click)="openDepartmentDetails(data)"
          >
            {{ data.departmentName }}
          </h5>
          <mat-icon [matMenuTriggerFor]="aboveMenu">more_vert</mat-icon>
          <mat-menu #aboveMenu="matMenu" yPosition="above">
            <button mat-menu-item (click)="createDepartment(data)">
              <mat-icon class="stroke-current stroke-1 mr-2">edit</mat-icon>
              Edit
            </button>
            <button mat-menu-item (click)="confirmDelete(data.id)">
              <mat-icon class="stroke-current stroke-1 mr-2"
                >delete_forever</mat-icon
              >
              Delete
            </button>
          </mat-menu>
        </div>
        <p class="text-sm">{{ data.departmentCode }}</p>
      </div>
      } }@else{
      <div class="text-center text-gray-500 mt-6">
        No Department found matching your criteria.
      </div>
      }
    </div>
  </div>
</div>
