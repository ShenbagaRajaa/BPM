<div class="h-screen bg-mBgBlue tablet:bg-lblue md:bg-lblue p-4">
  <app-navigationbar
    [arrow]="false"
    pageTitle="Task Action"
  ></app-navigationbar>

  <mat-card class="w-full flex-grow pb-64">
    <mat-card-content class="p-4">
      <div
        class="flex flex-row justify-end gap-4 md:hidden tablet:hidden"
        *ngIf="buttonContainer"
      >
        <button
          *ngIf="buttonShow"
          mat-raised-button
          class="mat-raised-button text-toolbarBg bg-text px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="onClick('REPORT PROBLEM')"
        >
          REPORT PROBLEM
        </button>
        <button
          mat-raised-button
          class="mat-raised-button text-toolbarBg bg-text px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="onClick(buttonValue)"
        >
          {{ buttonValue }}
        </button>
      </div>
      <!-- Plan Status Section -->
      <div
        class="flex flex-col tablet:flex-row md:flex-row items-start tablet:items-center md:items-center justify-between gap-2 mb-4"
      >
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="text-gray-600">Plan Name:</div>
          <div class="font-bold break-all">{{ plan.planName }}</div>
        </div>
        <app-status-highlighter
          [status]="plan.planStatus"
          class="w-full md:w-auto tablet:w-auto"
        ></app-status-highlighter>
      </div>

      <mat-divider class="my-4"></mat-divider>

      <div class="flex flex-col gap-4 mb-6 mt-4">
        <!-- Sequence ID -->
        <div
          class="flex flex-col tablet:flex-row md:flex-row justify-between gap-4"
        >
          <div class="flex flex-col md:flex-row md:items-center gap-2">
            <span class="text-gray-600">Sequence Number:</span>
            <span class="font-bold">{{ sequence.sequenceNumber }}</span>
          </div>
          <app-status-highlighter
            [status]="sequence.status"
            class="w-full md:w-auto tablet:w-auto"
          ></app-status-highlighter>
        </div>
        <div
          class="flex flex-col tablet:flex-row md:flex-row justify-between gap-4"
        >
          <!-- Task ID -->
          <div class="flex flex-col md:flex-row md:items-center gap-2">
            <span class="text-gray-600">Task Name:</span>
            <span class="font-bold break-all">{{ task.taskTitle }}</span>
          </div>
          <app-status-highlighter
            [status]="task.status"
            class="w-full md:w-auto tablet:w-auto"
          ></app-status-highlighter>
        </div>
        <div
          class="flex flex-col tablet:flex-row md:flex-row justify-between gap-4"
        >
          <div class="flex flex-col">
            <span class="text-gray-600">Task Description :</span>
            <span class="font-semibold text-justify">{{
              task.taskDescription
            }}</span>
          </div>
        </div>
        <div
          *ngIf="taskFileURL"
          class="w-full flex flex-col tablet:flex-row md:flex-row mobile:items-start items-center gap-2 mt-4"
        >
          <span class="text-gray-600">Attachment :</span>
          <a
            [href]="getTaskFileUrl()"
            target="_blank"
            class="inline-flex items-center underline text-blue-600 hover:text-blue-800 gap-1"
          >
           {{ taskFileName}}
          </a>
        </div>
      </div>

      <div
        *ngIf="resolveMessage || resolvingFilePath"
        class="w-full gap-4 mb-6"
      >
        <mat-divider class="py-4"></mat-divider>
        <div class="font-bold text-md mb-4">Resolved Problem:</div>
        <div class="w-full">
          <div class="font-medium text-md mb-2">Description :</div>
          <p class="text-justify">{{ resolveMessage }}</p>
        </div>
        <div
          *ngIf="resolvingFilePath"
          class="w-full flex flex-row items-center gap-2 mt-4"
        >
          <div class="font-medium text-md">Resolved File:</div>
          <a
            [href]="getResolvedFileUrl()"
            target="_blank"
            class="inline-flex items-center underline text-blue-600 hover:text-blue-800 gap-1"
          >
            {{ resolvingFileName }}
          </a>
        </div>
      </div>
      <mat-divider class="py-4"></mat-divider>

      <!-- Date/Time Cards -->
      <div
        class="grid grid-cols-1 tablet:grid-cols-2 md:grid-cols-2 md:grid-cols-3 gap-4 mb-6"
      >
        <mat-card *ngIf="ackowledge" class="bg-gray-50">
          <mat-card-content class="p-4">
            <h3 class="text-gray-600 text-md mb-2">Acknowledge Date/Time</h3>
            <p class="font-bold break-all">
              {{ ackowledgeDateTime | date : "yyyy-MM-dd hh:mm a" }}
            </p>
          </mat-card-content>
        </mat-card>

        <mat-card *ngIf="completion" class="bg-gray-50">
          <mat-card-content class="p-4">
            <h3 class="text-gray-600 text-md mb-2">Completion Date/Time</h3>
            <p class="font-bold break-all">
              {{ completionDateTime | date : "yyyy-MM-dd hh:mm a" }}
            </p>
          </mat-card-content>
        </mat-card>

        <mat-card *ngIf="problemReported" class="bg-gray-50">
          <mat-card-content class="p-4">
            <h3 class="text-gray-600 text-md mb-2">
              Problem Reported Date/Time
            </h3>
            <p class="font-bold break-all">
              {{ problemReportedDateTime | date : "yyyy-MM-dd hh:mm a" }}
            </p>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Action Buttons -->
      <div
        class="hidden flex-col tablet:flex-row md:flex-row justify-end gap-4 md:flex tablet:flex"
        *ngIf="buttonContainer"
      >
        <button
          *ngIf="buttonShow"
          mat-raised-button
          class="mat-raised-button text-toolbarBg bg-text px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="onClick('REPORT PROBLEM')"
        >
          REPORT PROBLEM
        </button>
        <button
          mat-raised-button
          class="mat-raised-button text-toolbarBg bg-text px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="onClick(buttonValue)"
        >
          {{ buttonValue }}
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
